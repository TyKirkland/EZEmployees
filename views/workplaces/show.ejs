<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EZEmployees</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.5/index.global.min.js'></script>
    <script>

        document.addEventListener('DOMContentLoaded', function() {
          var calendarEl = document.getElementById('calendar');
          var calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth',
            headerToolbar: {
                left: 'prev,next today',
                center: 'title',
                right: 'dayGridMonth,timeGridWeek,timeGridDay'
            }
          });
          calendar.render();
          let shiftToAdd = {};
          <% for(let i = 0; i < myShifts.length; i++) {%>
            <% if(myShifts[i].workplace === myWorkplace.id){ %>
            if('<%=myShifts[i].startTime%>' == ''){
                shiftToAdd = {
                    title: '<%= myShifts[i].title %>',
                    date: '<%= myShifts[i].start %>',
                    display: 'block',
                    url: '/schedules/<%=myWorkplace.id%>/<%=myShifts[i].id%>/shift'
                }
            }
            else{
                shiftToAdd = {
                    title: '<%= myShifts[i].title %>',
                    start: '<%= myShifts[i].start %>T<%= myShifts[i].startTime %>',
                    end: '<%= myShifts[i].start %>T<%= myShifts[i].endTime %>',
                    display: 'block',
                    url: '/schedules/<%=myWorkplace.id%>/<%=myShifts[i].id%>/shift'
                }
            }
            calendar.addEvent(shiftToAdd);
            <% } %>
          <% } %>
        });
  
    </script>

</head>
<body class="row my-custom-row align-items-center justify-content-center text-center" style="background-color:rgb(180,176,176)">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>

    <h1 class="row my-custom-row align-items-center justify-content-center"> <%= myWorkplace.name %> </h1>
    <div class="row my-custom-row align-items-center justify-content-center">
        <h5>Employees:</h5>
        <% for(let i = 0; i < myEmployees.length; i++) { %>
            <% if(myEmployees[i].workplace === myWorkplace.id){ %>
                <a href="/schedules/<%=myWorkplace.id%>/<%=myEmployees[i].id%>" ><h6 class="row my-custom-row align-items-center justify-content-center"> <%= myEmployees[i].name %> </h6></a>
            <% } %>
        <% } %>
        <a href="/schedules/<%=myWorkplace.id%>/newemployee">
            <button style="margin-top:10px">
                New Employee
            </button>
        </a>    
    </div>
    <a href="/schedules/<%=myWorkplace.id%>/newshift">
        <button style="position:relative;bottom:-50px">
            Create Shift
        </button>
    </a>
    <div class="row my-custom-row align-items-center justify-content-center" style="height:750px; width:750px;">
        <div class="row my-custom-row align-items-center justify-content-center" id="calendar" style="text-decoration: none;"></div>
    </div>
    <a href="/schedules">
        <button style="bottom:50px;position:relative">
            Back
        </button>
    </a>
    <a href="/schedules/<%=myWorkplace.id%>/edit">
        <button style="margin-bottom:5px">
            Edit Workplace
        </button>
    </a>
    <form method="POST" action="/schedules/<%= myWorkplace._id %>?_method=DELETE">
        <input type="submit" value="Delete Workplace" style="margin-bottom:10px">
    </form>    


</body>
</html>